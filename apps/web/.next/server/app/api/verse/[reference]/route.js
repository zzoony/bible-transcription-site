"use strict";(()=>{var e={};e.id=535,e.ids=[535],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},5653:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>_,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var n={};t.r(n),t.d(n,{GET:()=>u});var s=t(3036),a=t(5736),o=t(5262),i=t(942),l=t(5655),c=t(6612);async function u(e,{params:r}){let t=r.reference;if(!t)return i.NextResponse.json({error:"Reference parameter is required"},{status:400});let n=(0,c.rt)(t);if(!n)return i.NextResponse.json({error:"Invalid reference format",message:'Expected format: "book-chapter-verse" or "Book Chapter:Verse"'},{status:400});let{book:s,chapter:a,verse:o}=n,u=`${s} ${a}:${o}`;try{let e=(0,l.lx)(),{data:r,error:t}=await e.from("verses").select(`
        id,
        reference,
        niv_text,
        verse_number,
        book_id,
        chapter_id,
        analysis_completed,
        created_at,
        updated_at,
        books!inner(name_english),
        chapters!inner(chapter_number)
      `).eq("reference",u).single();if(t||!r)return i.NextResponse.json({reference:u,found:!1,data:null},{status:200,headers:{"Content-Type":"application/json","Cache-Control":"public, max-age=3600, s-maxage=7200"}});let n=(0,c.rt)(r.reference),s={id:r.id,book_id:r.book_id,chapter_id:r.chapter_id,verse_number:r.verse_number,reference:r.reference,niv_text:r.niv_text,analysis_completed:r.analysis_completed,created_at:r.created_at,updated_at:r.updated_at,book:n?.book||r.books.name_english,chapter:n?.chapter||r.chapters.chapter_number,verse:n?.verse||r.verse_number,text:r.niv_text},[{data:a},{data:o},{data:p},{data:d},{data:h}]=await Promise.all([e.from("sentence_structures").select("*").eq("verse_id",r.id).order("sequence_order",{ascending:!0}),e.from("vocabulary").select("*").eq("verse_id",r.id).order("id",{ascending:!0}),e.from("contextual_explanations").select("*").eq("verse_id",r.id).single(),e.from("korean_translations").select("*").eq("verse_id",r.id).single(),e.from("special_explanations").select("*").eq("verse_id",r.id).single()]);return i.NextResponse.json({reference:u,found:!0,data:{verse:s,sentence_structure:a||[],vocabulary:o||[],contextual_explanation:p||null,korean_translation:d||null,special_explanation:h||null}},{status:200,headers:{"Content-Type":"application/json","Cache-Control":"public, max-age=3600, s-maxage=7200"}})}catch(e){return console.error("Verse API error:",e),i.NextResponse.json({reference:u,found:!1,data:null,error:"Internal server error",message:e instanceof Error?e.message:"Unknown error"},{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/verse/[reference]/route",pathname:"/api/verse/[reference]",filename:"route",bundlePath:"app/api/verse/[reference]/route"},resolvedPagePath:"/Users/peter/Dev/bible-transcription-site/apps/web/app/api/verse/[reference]/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:m}=p,_="/api/verse/[reference]/route";function f(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},8652:(e,r,t)=>{t.d(r,{hO:()=>a,iJ:()=>s});let n={창세기:"Genesis",출애굽기:"Exodus",레위기:"Leviticus",민수기:"Numbers",신명기:"Deuteronomy",여호수아:"Joshua",사사기:"Judges",룻기:"Ruth",사무엘상:"1 Samuel",사무엘하:"2 Samuel",열왕기상:"1 Kings",열왕기하:"2 Kings",역대상:"1 Chronicles",역대하:"2 Chronicles",에스라:"Ezra",느헤미야:"Nehemiah",에스더:"Esther",욥기:"Job",시편:"Psalms",잠언:"Proverbs",전도서:"Ecclesiastes",아가:"Song of Solomon",이사야:"Isaiah",예레미야:"Jeremiah",예레미야애가:"Lamentations",에스겔:"Ezekiel",다니엘:"Daniel",호세아:"Hosea",요엘:"Joel",아모스:"Amos",오바댜:"Obadiah",요나:"Jonah",미가:"Micah",나훔:"Nahum",하박국:"Habakkuk",스바냐:"Zephaniah",학개:"Haggai",스가랴:"Zechariah",말라기:"Malachi",마태복음:"Matthew",마가복음:"Mark",누가복음:"Luke",요한복음:"John",사도행전:"Acts",로마서:"Romans",고린도전서:"1 Corinthians",고린도후서:"2 Corinthians",갈라디아서:"Galatians",에베소서:"Ephesians",빌립보서:"Philippians",골로새서:"Colossians",데살로니가전서:"1 Thessalonians",데살로니가후서:"2 Thessalonians",디모데전서:"1 Timothy",디모데후서:"2 Timothy",디도서:"Titus",빌레몬서:"Philemon",히브리서:"Hebrews",야고보서:"James",베드로전서:"1 Peter",베드로후서:"2 Peter",요한일서:"1 John",요한이서:"2 John",요한삼서:"3 John",유다서:"Jude",요한계시록:"Revelation"};function s(e){return n[e]||null}function a(e){let r=e.match(/^(.+?)\s+(\d+):(\d+)$/);if(!r)return null;let[,t,n,a]=r,o=s(t);return o?{book:o,chapter:parseInt(n),verse:parseInt(a)}:null}Object.fromEntries(Object.entries(n).map(([e,r])=>[r,e]))},5655:(e,r,t)=>{t.d(r,{lx:()=>o});var n=t(1337);function s(){let e=process.env.NEXT_PUBLIC_SUPABASE_URL;if(!e)throw Error("Missing env.NEXT_PUBLIC_SUPABASE_URL");return e}let a=null;function o(){let e=process.env.SUPABASE_SERVICE_KEY;if(!e)throw Error("Missing env.SUPABASE_SERVICE_KEY");return(0,n.eI)(s(),e,{auth:{persistSession:!1,autoRefreshToken:!1},db:{schema:"public"}})}process.env.NEXT_PUBLIC_SUPABASE_URL&&(a||(a=(0,n.eI)(s(),function(){let e=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!e)throw Error("Missing env.NEXT_PUBLIC_SUPABASE_ANON_KEY");return e}(),{auth:{persistSession:!1},db:{schema:"public"},global:{headers:{"x-application-name":"bible-transcription-site"}}})))},6612:(e,r,t)=>{t.d(r,{cn:()=>o,rt:()=>i});var n=t(9201),s=t(5832),a=t(8652);function o(...e){return(0,s.m6)((0,n.W)(e))}function i(e){let r=(0,a.hO)(e);if(r)return r;let t=e.match(/^([a-z]+)-(\d+)-(\d+)$/i);if(t)return{book:t[1].charAt(0).toUpperCase()+t[1].slice(1),chapter:parseInt(t[2]),verse:parseInt(t[3])};let n=e.match(/^([\w\s]+?)\s+(\d+):(\d+)$/i);if(n){let e=n[1].trim();return{book:e.charAt(0).toUpperCase()+e.slice(1),chapter:parseInt(n[2]),verse:parseInt(n[3])}}return null}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[193,105,174],()=>t(5653));module.exports=n})();