"use strict";(()=>{var e={};e.id=139,e.ids=[139],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},1069:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>v,serverHooks:()=>x,staticGenerationAsyncStorage:()=>h});var n={};t.r(n),t.d(n,{GET:()=>c,dynamic:()=>l});var s=t(3036),o=t(5736),i=t(5262),a=t(942),u=t(5655);function p(e){let r=e.match(/^(.+?)\s+(\d+):(\d+)$/);if(!r)return null;let[,t,n,s]=r;return{book:t.trim(),chapter:parseInt(n,10),verse:parseInt(s,10)}}let l="force-dynamic";async function c(e){try{let{searchParams:r}=new URL(e.url),t=r.get("reference"),n=r.get("direction");if(!t)return a.NextResponse.json({error:"구절 참조(reference)가 필요합니다"},{status:400});if(!n||!["next","prev"].includes(n))return a.NextResponse.json({error:'direction은 "next" 또는 "prev"여야 합니다'},{status:400});let s=p(t);if(!s)return a.NextResponse.json({error:'잘못된 구절 참조 형식입니다 (예: "Philippians 2:12")'},{status:400});let{book:o}=s,i=(0,u.lx)(),{data:l,error:c}=await i.from("verses").select("reference, verse_number").ilike("reference",`${o}%`).returns();if(c)return console.error("DB 조회 오류:",c),a.NextResponse.json({error:"데이터베이스 조회 중 오류가 발생했습니다"},{status:500});if(!l||0===l.length)return a.NextResponse.json({error:"해당 책의 구절을 찾을 수 없습니다"},{status:404});l.sort((e,r)=>{let t=p(e.reference),n=p(r.reference);return t&&n?t.chapter!==n.chapter?t.chapter-n.chapter:t.verse-n.verse:0});let v=l.findIndex(e=>e.reference===t);if(-1===v)return a.NextResponse.json({error:"현재 구절을 찾을 수 없습니다"},{status:404});let d=null;d="next"===n?v+1<l.length?v+1:null:v-1>=0?v-1:null;let h={current:t,target:null!==d?l[d].reference:null,hasTarget:null!==d};return a.NextResponse.json(h,{headers:{"Cache-Control":"public, max-age=3600, s-maxage=7200"}})}catch(e){return console.error("Navigation API 오류:",e),a.NextResponse.json({error:"서버 오류가 발생했습니다",...!1},{status:500})}}let v=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/verse/navigation/route",pathname:"/api/verse/navigation",filename:"route",bundlePath:"app/api/verse/navigation/route"},resolvedPagePath:"/Users/peter/Dev/bible-transcription-site/apps/web/app/api/verse/navigation/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:x}=v,f="/api/verse/navigation/route";function g(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:h})}},5655:(e,r,t)=>{t.d(r,{lx:()=>i});var n=t(1337);function s(){let e=process.env.NEXT_PUBLIC_SUPABASE_URL;if(!e)throw Error("Missing env.NEXT_PUBLIC_SUPABASE_URL");return e}let o=null;function i(){let e=process.env.SUPABASE_SERVICE_KEY;if(!e)throw Error("Missing env.SUPABASE_SERVICE_KEY");return(0,n.eI)(s(),e,{auth:{persistSession:!1,autoRefreshToken:!1},db:{schema:"public"}})}process.env.NEXT_PUBLIC_SUPABASE_URL&&(o||(o=(0,n.eI)(s(),function(){let e=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!e)throw Error("Missing env.NEXT_PUBLIC_SUPABASE_ANON_KEY");return e}(),{auth:{persistSession:!1},db:{schema:"public"},global:{headers:{"x-application-name":"bible-transcription-site"}}})))}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[193,174],()=>t(1069));module.exports=n})();